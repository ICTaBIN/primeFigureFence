{% extends "base-templates/base-fence.html" %}
{% load static %}

{% block title %}Chainlink Fence{% endblock %}

{% block styles %}
    <link rel="https://cdnjs.cloudflare.com/ajax/libs/inter/3.19.3/inter.css" rel="stylesheet">
<link href="{% static 'css/chainLink-fence.css' %}" rel="stylesheet">

<style>
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }

  .back-button {
    text-decoration: none;
    color: #333;
    margin-bottom: 20px;
    display: inline-block;
  }

  .summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }

  .summary-item {
    display: flex;
    flex-direction: column;
  }

  .summary-item label {
    margin-bottom: 5px;
    font-weight: bold;
  }

  .summary-item input,
  .summary-item select {
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
  }

  .tax-controls {
    margin-bottom: 20px;
  }

  .tax-options {
    display: flex;
    gap: 20px;
  }

  .materials-section {
    margin-bottom: 30px;
    overflow-x: auto;
  }

  #materialsTable {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
  }

  #materialsTable th,
  #materialsTable td {
    padding: 10px;
    border: 1px solid #ddd;
    text-align: left;
  }

  .quantity-input {
    width: 80px;
  }

  .button-group {
    display: flex;
    gap: 10px;
    margin-top: 20px;
  }

  .button-group button {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    background-color: #007bff;
    color: white;
    cursor: pointer;
  }

  .button-group button:hover {
    background-color: #0056b3;
  }

  .calculations-wrapper {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
  }

  .rates-section {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .rate-item {
    display: flex;
    flex-direction: column;
  }

  .rate-item label {
    margin-bottom: 5px;
    font-weight: bold;
  }

  .rate-item input {
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
  }

  .totals-section {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .total-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .final-total {
    font-size: 1.2em;
    font-weight: bold;
    margin-top: 20px;
    text-align: right;
  }
</style>
{% endblock %}


  <h1>{% block heading %}Chainlink Fence{% endblock %}</h1>


{% block scripts %}
<script src="{% static 'js/resize.js' %}"></script>


<script src="{% static 'js/drawing.js' %}"></script>
<script src="{% static 'js/chainlink-fence.js' %}"></script>
<script type="module" src="{% static 'js/templates.js' %}"></script>



<script>
  // Define variables to keep track of quantities
  var BarbWireQty = 0;
  var BraceBandsQty = 0;
  var ConcreteQty = 0;
  var HogTiesQty = 0;
  var LinePostCapsQty = 0;
  var LinePostsQty = 0;
  var MeshQty = 0;
  var TensionBandsQty = 0;
  var TensionBarsQty = 0;
  var TensionWireQty = 0;
  var TerminalCapsQty = 0;
  var TerminalPostsQty = 0;
  var TopRailQty = 0;
  var TopRailEndsQty = 0;
  var TrussBarsQty = 0;

  // Function to handle price updates based on dropdown selection
  function updatePrice(selectElement) {
      var selectedOption = selectElement.options[selectElement.selectedIndex];
      var material = selectedOption.getAttribute('material-type');
      var price = parseFloat(selectedOption.getAttribute('material-price')) || 0;

      console.log(`Material: ${material}, Price: ${price}`);

      // Update the price display element
      document.getElementById(`${material}Price`).textContent = '$' + price.toFixed(2);

      // Calculate total using the respective quantity
      var quantity = eval(`${material}Qty`) || 0; // Access the respective quantity variable
      document.getElementById(`${material}Total`).textContent = '$' + (price * quantity).toFixed(2);
  }

  // Function to handle quantity changes
  function qtyChange(element) {
      var quantity = parseInt(element.value) || 0; // Default to 0 if invalid
      console.log("Quantity changed to:", quantity);

      // Update the respective quantity variable
      if (element.id === "BarbWireQty") BarbWireQty = quantity;
      if (element.id === "BraceBandsQty") BraceBandsQty = quantity;
      if (element.id === "ConcreteQty") ConcreteQty = quantity;
      if (element.id === "HogTiesQty") HogTiesQty = quantity;
      if (element.id === "LinePostCapsQty") LinePostCapsQty = quantity;
      if (element.id === "LinePostsQty") LinePostsQty = quantity;
      if (element.id === "MeshQty") MeshQty = quantity;
      if (element.id === "TensionBandsQty") TensionBandsQty = quantity;
      if (element.id === "TensionBarsQty") TensionBarsQty = quantity;
      if (element.id === "TensionWireQty") TensionWireQty = quantity;
      if (element.id === "TerminalCapsQty") TerminalCapsQty = quantity;
      if (element.id === "TerminalPostsQty") TerminalPostsQty = quantity;
      if (element.id === "TopRailQty") TopRailQty = quantity;
      if (element.id === "TopRailEndsQty") TopRailEndsQty = quantity;
      if (element.id === "TrussBarsQty") TrussBarsQty = quantity;

      // Extract material type from the element's ID
      var material = element.id.replace("Qty", "");

      // Get the price for the material
      var price = parseFloat(document.getElementById(`${material}Price`).textContent.replace('$', '')) || 0;

      console.log(`Material: ${material}, Price: ${price}, Quantity: ${quantity}`);

      // Update the total price for the material
      document.getElementById(`${material}Total`).textContent = '$' + (quantity * price).toFixed(2);
  }
</script>


{% endblock %}